<div class="panel panel-danger">
    <div class="panel-heading">
        <h2>ReDoS - Regex Denial of Service (AngularJS)</h2>
    </div>
    <div class="panel-body">
        
        <!-- Section 1: Email Validation -->
        <div class="well">
            <h3>1. Validation Email Vuln√©rable</h3>
            <input type="text" ng-model="emailInput" class="form-control" 
                   placeholder="Email (essayez: aaaaaaaaaaaaaaaaaaaaaaaa@)">
            <button ng-click="validateEmailUnsafe()" class="btn btn-danger" 
                    ng-disabled="processing">
                Valider Email
            </button>
            <button ng-click="emailInput = generateMaliciousInput('email')" class="btn btn-warning">
                G√©n√©rer Input Malveillant
            </button>
            <p ng-show="processing" class="text-danger">
                <strong>‚è≥ Processing...</strong> (ReDoS en cours!)
            </p>
            
            <div class="alert alert-info">
                <strong>üí° Pour tester :</strong>
                <ul>
                    <li>Cliquez "G√©n√©rer Input Malveillant" puis "Valider Email"</li>
                    <li>Ou entrez : <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa@</code></li>
                    <li>Pattern vuln√©rable : <code>/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/</code></li>
                </ul>
                <strong>‚ö†Ô∏è Si le navigateur freeze = ReDoS d√©tect√© !</strong>
            </div>
        </div>

        <!-- Section 2: URL Validation -->
        <div class="well">
            <h3>2. Validation URL Complexe</h3>
            <input type="text" ng-model="urlInput" class="form-control" 
                   placeholder="URL √† valider">
            <button ng-click="validateURLUnsafe()" class="btn btn-danger">
                Valider URL
            </button>
            <p class="text-muted">
                Pattern: <code>/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/</code>
            </p>
            
            <div class="alert alert-info">
                <strong>üí° Pour tester :</strong>
                <ul>
                    <li><code>http://aaaaaaaaaaaaaaaaaaaaaaaaaaa.</code></li>
                    <li><code>https://example.com/aaaaaaaaaaaaaaaaaaaaaa </code> (espace √† la fin)</li>
                    <li>Le <code>*</code> imbriqu√© cause un backtracking catastrophique</li>
                </ul>
            </div>
        </div>

        <!-- Section 3: Quantificateurs Imbriqu√©s -->
        <div class="well">
            <h3>3. Quantificateurs Imbriqu√©s</h3>
            <input type="text" ng-model="testString" class="form-control" 
                   placeholder="String de test">
            <button ng-click="nestedQuantifiers()" class="btn btn-danger">
                Test (a+)+b
            </button>
            <button ng-click="testString = generateMaliciousInput('nested')" class="btn btn-warning">
                G√©n√©rer "aaa...!"
            </button>
            <p class="text-danger">Patterns dangereux: (a+)+, (a*)*, (a+)*</p>
            
            <div class="alert alert-info">
                <strong>üí° Pour tester :</strong>
                <ul>
                    <li>Pattern <code>/(a+)+b/</code> avec input <code>aaaaaaaaaaaaaaaaaaaaaa!</code></li>
                    <li>Complexit√© : O(2^n) - croissance exponentielle !</li>
                    <li>20 'a' = 1 million d'op√©rations</li>
                    <li>30 'a' = 1 milliard d'op√©rations üí•</li>
                </ul>
            </div>
        </div>

        <!-- Section 4: Password Validation -->
        <div class="well">
            <h3>4. Validation Mot de Passe Complexe</h3>
            <input type="password" ng-model="testString" class="form-control" 
                   placeholder="Mot de passe">
            <button ng-click="validatePasswordUnsafe()" class="btn btn-danger">
                Valider Password
            </button>
            <p>Utilise des lookaheads multiples: (?=.*[a-z])(?=.*[A-Z])...</p>
            
            <div class="alert alert-info">
                <strong>üí° Pour tester :</strong>
                <ul>
                    <li>Input long sans caract√®res sp√©ciaux : <code>AAAaaaaaaaaaaaaaaaaaaaaa</code></li>
                    <li>Les lookaheads multiples causent du backtracking</li>
                    <li>Pattern : <code>/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]+$/</code></li>
                </ul>
            </div>
        </div>

        <!-- Section 5: Phone Number -->
        <div class="well">
            <h3>5. Validation Num√©ro de T√©l√©phone</h3>
            <input type="text" ng-model="phoneInput" class="form-control" 
                   placeholder="Num√©ro de t√©l√©phone">
            <button ng-click="validatePhoneUnsafe()" class="btn btn-danger">
                Valider T√©l√©phone
            </button>
            <button ng-click="phoneInput = generateMaliciousInput('phone')" class="btn btn-warning">
                Input Malveillant
            </button>
            
            <div class="alert alert-info">
                <strong>üí° Pour tester :</strong>
                <ul>
                    <li>Pattern vuln√©rable : <code>/^(\d+[-.\s]?)+$/</code></li>
                    <li>Input : <code>1111111111111111111111111</code></li>
                    <li>Le <code>+</code> apr√®s le groupe cause le probl√®me</li>
                </ul>
            </div>
        </div>

        <!-- Section 6: Custom Regex -->
        <div class="well">
            <h3>6. Regex Personnalis√©e (Danger!)</h3>
            <input type="text" ng-model="customPattern" class="form-control" 
                   placeholder="Pattern regex (ex: (a+)+$)">
            <input type="text" ng-model="testString" class="form-control" 
                   placeholder="String √† tester">
            <button ng-click="testCustomRegex()" class="btn btn-danger">
                Tester Regex
            </button>
            <p class="text-danger">‚ö†Ô∏è L'utilisateur contr√¥le la regex!</p>
            
            <div class="alert alert-info">
                <strong>üí° Patterns ReDoS √† essayer :</strong>
                <ul>
                    <li>Pattern: <code>(a+)+$</code> String: <code>aaaaaaaaaaaaaaaa!</code></li>
                    <li>Pattern: <code>(a|a)*</code> String: <code>aaaaaaaaaaaaaaaa</code></li>
                    <li>Pattern: <code>(.*a){x}$</code> String: <code>aaaaaaaaaaaaaaa</code></li>
                </ul>
            </div>
        </div>

        <!-- Section 7: HTML Parsing -->
        <div class="well">
            <h3>7. Parser HTML avec Regex (Mauvaise Id√©e!)</h3>
            <textarea ng-model="testString" class="form-control" rows="3" 
                      placeholder="<div class='test'><p>HTML √† parser</p></div>"></textarea>
            <button ng-click="parseHTMLUnsafe()" class="btn btn-danger">
                Parser HTML
            </button>
            <p class="text-warning">
                Parser du HTML avec regex est une mauvaise pratique ET vuln√©rable au ReDoS!
            </p>
            
            <div class="alert alert-info">
                <strong>üí° Pour tester :</strong>
                <pre>&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;</pre>
                <p>Les tags imbriqu√©s causent un backtracking exponentiel</p>
            </div>
        </div>

        <!-- Section 8: Multiple Patterns -->
        <div class="well">
            <h3>8. Validations Multiples en S√©quence</h3>
            <input type="text" ng-model="testString" class="form-control" 
                   placeholder="String √† valider">
            <button ng-click="multipleRegexValidation()" class="btn btn-danger">
                Ex√©cuter Toutes les Validations
            </button>
            <p>Teste 5 patterns vuln√©rables en s√©quence!</p>
            
            <div class="alert alert-info">
                <strong>üí° Pour tester :</strong>
                <p>Input qui d√©clenche plusieurs ReDoS : <code>aaaaaaaaaaaaaaaaaaa123</code></p>
            </div>
        </div>

        <!-- Exemples de Patterns Dangereux -->
        <div class="well">
            <h3>9. Patterns ReDoS Courants</h3>
            <div class="alert alert-warning">
                <h4>Patterns √† √©viter:</h4>
                <ul>
                    <li><code>(a+)+</code> - Quantificateurs imbriqu√©s</li>
                    <li><code>(a*)*</code> - Double √©toile</li>
                    <li><code>(a|a)*</code> - Alternance redondante</li>
                    <li><code>(a|ab)+</code> - Chevauchement dans alternance</li>
                    <li><code>^(a+)+$</code> - Ancrage avec imbrication</li>
                </ul>
                
                <h4>Temps d'ex√©cution :</h4>
                <table class="table">
                    <tr><th>Input Length</th><th>Op√©rations</th><th>Temps estim√©</th></tr>
                    <tr><td>10 chars</td><td>1,024</td><td>~1ms</td></tr>
                    <tr><td>20 chars</td><td>1,048,576</td><td>~1s</td></tr>
                    <tr><td>30 chars</td><td>1,073,741,824</td><td>~17min</td></tr>
                    <tr><td>40 chars</td><td>1,099,511,627,776</td><td>~12 jours</td></tr>
                </table>
            </div>
        </div>

        <!-- Indicateur de Performance -->
        <div class="alert alert-danger">
            <h4>üö® Impact ReDoS:</h4>
            <p>
                Les regex vuln√©rables peuvent causer une complexit√© O(2^n) ou pire,
                gelant le navigateur avec des entr√©es de seulement 20-30 caract√®res!
            </p>
            <p>
                <strong>Test:</strong> Si le navigateur se fige ou ralentit significativement,
                c'est un signe de ReDoS.
            </p>
            
            <strong>Comment d√©tecter :</strong>
            <ul>
                <li>CPU √† 100% sur un seul thread</li>
                <li>Page qui ne r√©pond plus</li>
                <li>Impossible de cliquer ou scroller</li>
                <li>Console DevTools qui freeze</li>
            </ul>
        </div>

    </div>
</div>
<div class="panel panel-danger">
    <div class="panel-heading">
        <h2>PostMessage Vuln√©rabilit√©s (AngularJS)</h2>
    </div>
    <div class="panel-body">
        
        <!-- Section 0: Activer les listeners -->
        <div class="well">
            <h3>0. Activer les Listeners PostMessage</h3>
            <button ng-click="activateListeners()" class="btn btn-warning" ng-disabled="listenersActive">
                {{ listenersActive ? 'Listeners Actifs' : 'Activer les Listeners' }}
            </button>
            <p class="text-info">
                <strong>‚ÑπÔ∏è Info :</strong> Les listeners ne sont pas actifs par d√©faut pour √©viter les popups au chargement.
                Cliquez ce bouton pour activer les vuln√©rabilit√©s PostMessage.
            </p>
        </div>
        
        <!-- Section 1: Envoi de Messages -->
        <div class="well">
            <h3>1. Envoyer PostMessage</h3>
            <input type="text" ng-model="messageToSend" class="form-control" 
                   placeholder="Message √† envoyer">
            <input type="text" ng-model="targetOrigin" class="form-control" 
                   placeholder="Origine cible (d√©faut: *)" value="*">
            <button ng-click="sendToAnyOrigin()" class="btn btn-danger">
                Envoyer √† n'importe quelle origine (*)
            </button>
            <p class="text-danger">Utiliser '*' expose les donn√©es √† tous les domaines!</p>
            
            <div class="alert alert-info">
                <strong>üí° Pour tester :</strong>
                <ul>
                    <li>Message : <code>{"secret": "mot-de-passe-123", "token": "abc123"}</code></li>
                    <li>Origine : <code>*</code> (dangereux !)</li>
                    <li>Ouvrez la console ‚Üí Tous les frames peuvent recevoir ce message</li>
                    <li>Alternative s√ªre : <code>https://trusted-domain.com</code></li>
                </ul>
            </div>
        </div>

        <!-- Section 2: Messages Re√ßus -->
        <div class="well">
            <h3>2. Messages Re√ßus (Sans Validation)</h3>
            <div class="alert" ng-class="{'alert-danger': listenersActive, 'alert-warning': !listenersActive}">
                <strong>{{ listenersActive ? '‚ö†Ô∏è Listeners actifs:' : '‚è∏Ô∏è Listeners inactifs:' }}</strong> 
                {{ listenersActive ? '√âcoute TOUS les messages sans v√©rifier l\'origine!' : 'Activez les listeners pour recevoir des messages' }}
            </div>
            <div ng-repeat="msg in receivedMessages" class="alert alert-warning">
                <strong>Origine:</strong> {{msg.origin}}<br>
                <strong>Donn√©es:</strong> {{msg.data | json}}
            </div>
            <div id="message-output" class="output"></div>
            
            <div class="alert alert-info">
                <strong>üí° Pour tester la r√©ception :</strong>
                <ol>
                    <li>D'abord, activez les listeners (bouton section 0)</li>
                    <li>Ouvrez la Console DevTools (F12)</li>
                    <li>Tapez : <code>window.postMessage({test: "Message re√ßu!"}, '*')</code></li>
                    <li>Le message appara√Æt sans v√©rification d'origine !</li>
                </ol>
            </div>
        </div>

        <!-- Section 3: Simulation d'Attaque -->
        <div class="well">
            <h3>3. Simuler une Attaque PostMessage</h3>
            <button ng-click="simulateMessage()" class="btn btn-danger" ng-disabled="!listenersActive">
                Simuler Message Malveillant
            </button>
            <p ng-show="!listenersActive" class="text-warning">
                ‚ö†Ô∏è Activez d'abord les listeners pour que cette attaque fonctionne
            </p>
            <p>Envoie un message avec: action (eval), html (XSS), command (redirect)</p>
            
            <div class="alert alert-info">
                <strong>üí° Ce que fait ce bouton :</strong>
                <pre>{
  action: "console.log('Message re√ßu!')",     // Ex√©cut√© via eval()
  html: "&lt;img src=x onerror='alert(1)'&gt;",  // Inject√© dans innerHTML
  command: "redirect",                         // D√©clenche une redirection
  url: "http://evil.com"                      // Vers cette URL
}</pre>
                <strong>Impact :</strong> Code ex√©cut√© + XSS + Redirection !
            </div>
        </div>

        <!-- Reste du template identique... -->
        <!-- Section 4: Broadcast de Donn√©es -->
        <div class="well">
            <h3>4. Broadcast de Donn√©es Sensibles</h3>
            <button ng-click="broadcastSensitiveData()" class="btn btn-danger">
                Diffuser Donn√©es Sensibles
            </button>
            <p class="text-danger">
                Diffuse mots de passe, tokens et cl√©s API √† TOUTES les fen√™tres!
            </p>
            
            <div class="alert alert-info">
                <strong>üí° Pour voir les donn√©es diffus√©es :</strong>
                <ol>
                    <li>Ajoutez d'abord des donn√©es : 
                        <br><code>localStorage.setItem('password', 'SuperSecret123')</code>
                        <br><code>localStorage.setItem('authToken', 'Bearer eyJ...')</code>
                    </li>
                    <li>Cliquez le bouton</li>
                    <li>Regardez la console ‚Üí Les donn√©es sont envoy√©es √† TOUS</li>
                </ol>
            </div>
        </div>

        <!-- Section 5: Auto-R√©pondeur -->
        <div class="well">
            <h3>5. R√©ponse Automatique Active</h3>
            <div class="alert" ng-class="{'alert-danger': listenersActive, 'alert-info': !listenersActive}">
                <strong>{{ listenersActive ? '‚ö†Ô∏è DANGER:' : '‚ÑπÔ∏è Info:' }}</strong> 
                {{ listenersActive ? 'R√©pond automatiquement avec les donn√©es localStorage/sessionStorage √† TOUS les messages!' : 'L\'auto-r√©pondeur sera actif apr√®s activation des listeners' }}
            </div>
            
            <div class="alert alert-info">
                <strong>üí° Pour tester l'auto-r√©pondeur :</strong>
                <pre>
// Dans la console, cr√©ez un listener
window.addEventListener('message', function(e) {
    console.log('R√©ponse re√ßue:', e.data);
});

// Envoyez un message
window.postMessage({request: 'getData'}, '*');

// L'auto-r√©pondeur envoie automatiquement vos donn√©es !
                </pre>
            </div>
        </div>

        <!-- Les autres sections restent identiques... -->

    </div>
</div>